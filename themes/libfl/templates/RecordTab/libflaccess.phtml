<?php

    // Set page title.
    $this->headTitle($this->translate('tabAccess') . ': ' . $this->driver->getBreadcrumb());
    $formatter = $this->recordDataFormatter();

    $exemplars = array();
    $getExemplars = $formatter->getData($driver, $formatter->getDefaults('libfl_exemplar'));
    if (isset($getExemplars['Exemplar']['value']) && !empty($getExemplars['Exemplar']['value'])) {
        $getExemplarsData = json_decode(htmlspecialchars_decode($getExemplars['Exemplar']['value']));
        $exemplars = json_decode($getExemplarsData[1][0]);
    }

    $accessMethods = $this->driver->getMethodOfAccess();
    $sortExemplars = $this->tab->sortExemplars($accessMethods, $exemplars);

    echo '<pre>';
    print_r($sortExemplars);
    echo '</pre>';

    foreach ($sortExemplars as $accessMethod=>$accessGroups) {
        echo "<div class='".$accessMethod."'>";
        switch ($accessMethod) {
            case 'access_remoteAccess':
                echo "<h2 style='margin-top:30px;'><i class='fa fa-laptop' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc($accessMethod)."</h2>";
                break;
            case 'access_printAccess':
                echo "<h2 style='margin-top:30px;'><i class='fa fa-print' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc($accessMethod)."</h2>";
                break;
            case 'access_homeAccess':
                echo "<h2 style='margin-top:30px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc($accessMethod)."</h2>";
                break;
            case 'access_libraryAccess':
                echo "<h2 style='margin-top:30px;'><i class='fa fa-bank' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc($accessMethod)."</h2>";
                echo "<p style='padding: 0px 0px 0px 23px;'><a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc('access_drivingDirections')."</a>&nbsp;|&nbsp;<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc('access_schedule')."</a></p>";
                break;
            case 'access_clarifyAccess':
                echo "<h2 style='margin-top:30px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc($accessMethod)."</h2>";
                break;
            default:
                echo "<h2 style='margin-top:30px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc($accessMethod)."</h2>";
                break;
        }
        foreach ($accessGroups as $accessGroup => $accessCodes) {
            echo "<div class='access_group_".$accessGroup."'>";
            switch ($accessGroup) {
                case '1':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '2':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '3':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '4':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '5':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '6':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='fa fa-book' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    echo "<p style='padding: 0px 0px 0px 23px;'><a href='http://opac.libfl.ru/personal/help.aspx' target='_blank'>".$this->transEsc('access_instructionsForOrderingBooksAtLibrary')."</a></p>";
                    echo "<div style='padding: 10px 0px 10px 35px; color:#d44848;'>
                        <strong>ПРИМЕЧАНИЕ:</strong><br>
                        Все экзмепляры находяться исключительно в книгохранении (<u>другие варианты невозможны</u>  ).<br>
                        Читатель добавляет книгу в корзину, оформляет заказ и получает книгу в зале выдачи докуементов (2 этаж)
                        <ul>
                            <li>а11111 - access: 1005 (заказать через личный кабинет); location: 2011</li>
                            <li>а22222 - access: 1005 (заказать через личный кабинет); location: 2011</li>
                            <li>а33333 - access: 1005 (заказать через личный кабинет); location: 2011</li>
                            <li>а44444 - access: 1005 (заказать через личный кабинет); location: 2011</li>
                            <li>b44444 - access: 1005 (заказать через личный кабинет); location: 2011</li>
                            <li>c22222 - access: 1005 (заказать через личный кабинет); location: 2011</li>
                        </ul>
                        </div>";
                    break;
                case '7':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '8':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    echo "<div style='padding: 10px 0px 10px 35px; color:#d44848;'>
                        <strong>ПРИМЕЧАНИЕ:</strong><br>
                        Электронные экземпляры, доступные исключительно в помещении библиотеки (микрофиши, ресурсы НЭБ и пр.)
                        <ul>
                            <li>с44444 - access: 1003 (электронный доступ в помещении библиотеки); location: 2030</li>
                        </ul>
                        </div>";
                    break;
                case '9':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    echo "<div style='padding: 10px 0px 10px 35px; color:#d44848;'>
                        <strong>ПРИМЕЧАНИЕ:</strong><br>
                        Экземпляры имеют разный способ доступа и находятся в разных местах/залах.<br>
                        <ul>
                            <li>2325727, 2271976, 1536326 - access: 1014 (Доступ в залах библиотеки)); location: 2011</li>
                            <li>b33333 - access: 1007 (Доступ в залах библиотеки); location: 2032</li>
                            <li>c11111 - access: 1007 (Доступ в залах библиотеки)); location: 2003</li>
                        </ul>
                        Если экземпляр находится в книгохренении, при присваиваем ему отдельный статус доступа (1014).
                        </div>";
                    break;
                case '10':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    echo "<div style='padding: 10px 0px 10px 35px; color:#d44848;'>
                        <strong>ПРИМЕЧАНИЕ:</strong><br>
                        Книги находятся на выставке.<br>
                        <ul>
                            <li>с33333 - access: 1011 (книга на выставке); location: 2003</li>
                        </ul>
                        </div>";
                    break;
                case '11':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '12':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                case '13':
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
                default:
                    echo "<h3 style='font-weight:bold; padding-bottom:0px;'><i class='' style='margin: 0px 5px 0px 0px;'></i>".$this->transEsc('access_group_'.$accessGroup)."</h3>";
                    break;
            }
            foreach ($accessCodes as $access => $exemplar) {
                echo "<div id='group_".$access."' class='exemplar' style='padding: 0px 0px 0px 23px;'>";
                switch ($exemplar['exemplar_access_group']) {
                    case '1':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_hyperlink').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='".$exemplar['exempalr_hyperlink']."'>".$this->transEsc('access_read')."</a></div>";
                        echo "</div>";
                        break;
                    case '2':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_hyperlink').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='".$exemplar['exempalr_hyperlink']."'>".$this->transEsc('access_gainAccess')."</a></div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%link%%", "<a href='//opac.libfl.ru/WebReaderT/(S(ev5t1wja0rchxr20r5gnvh55))/Default.aspx' target='_blank'>".$this->transEsc('access_toRegister')."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        echo "</div>";
                        break;
                    case '3':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_hyperlink').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='".$exemplar['exempalr_hyperlink']."'>".$this->transEsc('access_gainAccess')."</a></div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%link%%", "<a href='//opac.libfl.ru/WebReaderT/(S(ev5t1wja0rchxr20r5gnvh55))/Default.aspx' target='_blank'>".$this->transEsc('access_toRegister')."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('access_additionalInfo').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='//libfl.ru/static/litres' target='_blank'>".$this->transEsc('access_descriptionLitres')."</a></div>";
                        echo "</div>";
                        break;
                    case '4':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_hyperlink').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='".$exemplar['exempalr_hyperlink']."'>".$this->transEsc('access_gainAccess')."</a></div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%link%%", "<a href='//opac.libfl.ru/WebReaderT/(S(ev5t1wja0rchxr20r5gnvh55))/Default.aspx' target='_blank'>".$this->transEsc('access_toRegister')."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('access_additionalInfo').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='//ebooks.libfl.ru/' target='_blank'>".$this->transEsc('access_descriptionPearson')."</a></div>";
                        echo "</div>";
                        break;
                    case '5':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_hyperlink').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='".$exemplar['exempalr_hyperlink']."'>".$this->transEsc('access_makeRequest')."</a></div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%access_LIBFL%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc('access_LIBFL')."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        echo "</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('access_additionalInfo').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='//ebooks.libfl.ru/' target='_blank'>".$this->transEsc('access_descriptionPrintOnDemand')."</a></div>";
                        echo "</div>";
                        break;
                    case '6':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        //echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc($exemplar['exemplar_location'])."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        if ($exemplar['exemplar_access_code'] == 1000) :
                            echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc('access_staticLocation_2006')."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        elseif ($exemplar['exemplar_access_code'] == 1005):
                            echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc('access_staticLocation_2007')."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        else:
                            echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->transEsc('access_unavailableExemplarLocation')."</div>";
                        endif;
                        echo "</div>";
                        break;
                    case '7':
                        echo "<div></div>";
                        echo "<div></div>";
                        break;
                    case '8':
                    echo "<div class='row'>";
                    echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_hyperlink').": </div>";
                    echo "<div class='col-sm-12 col-md-9 col-lg-9'><a href='".$exemplar['exempalr_hyperlink']."'>".$this->transEsc('access_gainAccess')."</a></div>";
                    echo "</div>";
                    echo "<div class='row'>";
                    echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                    echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc($exemplar['exemplar_location'])."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                    echo "</div>";
                        break;
                    case '9':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_inventory_number').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>";
                        if (is_array($exemplar['exemplar_inventory_number'])):
                            foreach ($exemplar['exemplar_inventory_number'] as $inv_number):
                                echo "<span style='padding: 0px 7px 0px 0px;'>".$inv_number."</span>";
                            endforeach;
                        else:
                            echo $this->transEsc('access_not_inventory_number');
                        endif;
                        echo "</div>";
                        echo"</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_rack_location').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>";
                        if (is_array($exemplar['exemplar_rack_location'])):
                            foreach ($exemplar['exemplar_rack_location'] as $rack_location):
                                echo "<span style='padding: 0px 7px 0px 0px;'>".$rack_location."</span>";
                            endforeach;
                        else:
                            echo $this->transEsc('access_not_inventory_number');
                        endif;
                        echo "</div>";
                        echo"</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_placing_cipher').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>";
                        if (is_array($exemplar['exemplar_placing_cipher'])):
                            foreach ($exemplar['exemplar_placing_cipher'] as $placing_cipher):
                                echo "<span style='padding: 0px 7px 0px 0px;'>".$placing_cipher."</span>";
                            endforeach;
                        else:
                            echo $this->transEsc('access_not_inventory_number');
                        endif;
                        echo "</div>";
                        echo"</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        if ($exemplar['exemplar_access_code'] == 1007) :
                            echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc($exemplar['exemplar_location'])."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        elseif ($exemplar['exemplar_access_code'] == 1014):
                            echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc(2007)."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        else:
                            echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->transEsc('access_unavailableExemplarLocation')."</div>";
                        endif;
                        echo "</div>";
                        break;
                    case '10':
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_inventory_number').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>";
                        if (is_array($exemplar['exemplar_inventory_number'])):
                            foreach ($exemplar['exemplar_inventory_number'] as $inv_number):
                                echo "<span style='padding: 0px 7px 0px 0px;'>".$inv_number."</span>";
                            endforeach;
                        else:
                            echo $this->transEsc('access_not_inventory_number');
                        endif;
                        echo "</div>";
                        echo"</div>";
                        echo "<div class='row'>";
                        echo "<div class='col-sm-12 col-md-3 col-lg-3' style='font-weight: bold;'>".$this->transEsc('exemplar_access').": </div>";
                        echo "<div class='col-sm-12 col-md-9 col-lg-9'>".$this->translate(str_replace("%%exemplar_location%%", "<a href='//libfl.ru/ru/item/contacts' target='_blank'>".$this->transEsc($exemplar['exemplar_location'])."</a>", $this->transEsc($exemplar['exemplar_access_code'])))."</div>";
                        echo "</div>";
                        break;
                    case '11':
                        echo "<div></div>";
                        echo "<div></div>";
                        break;
                    case '12':
                        echo "<div></div>";
                        echo "<div></div>";
                        break;
                    case '13':
                        echo "<div></div>";
                        echo "<div></div>";
                        break;
                    default:
                        /*echo "<div><div style='display:inline-block; width:30%; vertical-align:top; font-weight:bold; padding-right:10px;'>".$this->transEsc('exemplar_inventory_number').": </div>";
                        echo "<div style='display:inline-block; width:70%'>";
                        if (is_array($exemplar['exemplar_inventory_number'])):
                            foreach ($exemplar['exemplar_inventory_number'] as $inv_number):
                                echo "<span style='padding: 0px 7px 0px 0px;'>".$inv_number."</span>";
                            endforeach;
                        else:
                            echo $this->transEsc('access_not_inventory_number');
                        endif;
                        echo "</div></div>";
                        echo "<div><div style='display:inline-block; width:30%; vertical-align:top; font-weight:bold; padding-right:10px;'>".$this->transEsc('access_additionalInfo').": </div>";
                        echo "<div style='display:inline-block; width:70%; padding: 0px 0px 20px 0px;'>".$this->transEsc($exemplar['exemplar_access_code'])."</div></div>";*/
                        break;
                }
                echo "</div>";
            }

            /*foreach ($accessCodes as $access_location_codes => $exemplar) {
                $codes = explode('.', $access_location_codes);
                $accessCode = $codes[0];
                $locationCode = $codes[1];
                echo "<div id='group_".$access_location_codes."' class='exemplar' style='padding: 0px 0px 0px 23px;'>";
                //echo "<table class='table table-striped' summary='".$this->transEsc('Exemplars')."' style='margin-bottom:40px;'>";
                switch ($accessCode) {
                    case '1000':
                        break;
                    case '1001':
                        break;
                    case '1002':
                        break;
                    case '1003':
                        break;
                    case '1004':
                        break;
                    case '1005':
                        echo '<tr><td>1005</td></tr>';
                        break;
                    case '1006':
                        break;
                    case '1007':
                        break;
                    case '1008':
                        break;
                    case '1009':
                        break;
                    case '1010':
                        break;
                    case '1011':
                        break;
                    case '1012':
                        break;
                    case '1013':
                        break;
                    case '1014':
                        break;
                    case '1999':
                        break;
                    default:
                        break;
                }
                //echo "</table>";
                echo "</div>";
            }*/
            echo "</div>";
        }
        echo "</div>";
    }
?>
